%%%%%
%%%%%  Naudokite LUALATEX, ne LATEX.
%%%%%
%%%%
\documentclass[]{VUMIFTemplateClass}

\usepackage{indentfirst}
\usepackage{amsmath, amsthm, amssymb, amsfonts}
\usepackage{mathtools}
\usepackage{physics}
\usepackage{graphicx}
\usepackage{verbatim}
\usepackage[hidelinks]{hyperref}
\usepackage{color,algorithm,algorithmic}
\usepackage[nottoc]{tocbibind}
\usepackage{tocloft}

% plots
\usepackage{pgfplots}
\pgfplotsset{width=5cm,compat=1.9}
\newcommand{\mathdefault}[1][]{} % to fix pgfplots

\usepackage{titlesec}
\newcommand{\sectionbreak}{\clearpage}

\makeatletter
\renewcommand{\fnum@algorithm}{\thealgorithm}
\makeatother
\renewcommand\thealgorithm{\arabic{algorithm} algoritmas}

\usepackage{biblatex}
\bibliography{bibliografija}
%% norint pakeisti bibliografijos šaltinių numeravimą (skaitiniu arba raidiniu), pakeitimus atlikti VUMIFTemplateClass.cls 150 eilutėje

% Author's MACROS
% variables
\newcommand{\tone}{0.1}
\newcommand{\ttwo}{0.05}

\studijuprograma{\{Studijų programos\}} %Studijų programą įrašyti kilmininko linksniu (pavyzdžiui – Programų sistemų, Finansų ir draudimų matematikos ir t. t.)
\darbotipas{\{Darbo tipas\}} % Bakalauro baigiamasis darbas arba magistro baigiamasis darbas
\darbopavadinimas{Darbo pavadinimas lietuvių kalba}
\darbopavadinimasantras{Work Title in English}
\autorius{Vardas Pavardė}

%Autorių gali būti ir daugiau, tuo atveju, kiekvienas autorius rašomas iš naujos eilutės, ir pridedamas titulinis.tex arba dvigubasTitulinis.tex dokumentuose
%\antrasautorius{Vardas Pavardė} %Jei toks yra, kitu atveju ištrinti

\vadovas{pedagoginis/mokslinis vardas Vardas Pavardė}
\recenzentas{pedagoginis/mokslinis vardas Vardas Pavardė} %Jei toks yra žinomas, kitu atveju ištrinti
\moksliniskonsultantas{pedagoginis/mokslinis vardas Vardas Pavardė} %Jei toks yra žinomas, kitu atveju ištrinti

\begin{document}
\onehalfspacing
\input{titulinis}

\selectlanguage{lithuanian}
%Turinys
\tableofcontents
\onehalfspacing

\section{Įvadas}
Analizuojamas Koši uždavinys pagal uždavinio sąlygą:
\begin{equation}
    \begin{cases}
        \frac{du}{dx} = x \ln(x + u) + 2x,\\
        u(0) = 1.
    \end{cases}
\end{equation}

Šį uždavinį spręsime 4-pakopiu Rungės-Kuto metodu ir dvipakopiu (kai $\sigma = 0.5$) Rungės-Kuto metodu. Sprendinius palyginsime su Python bibliotekos \texttt{spicy} metodu \texttt{spicy.integrate.solve\_ivp} gautais sprendiniais.

\section{Keturpakopis Rungės-Kuto metodas}
\begin{equation}
    \begin{cases}
        k_1 = f(t_n, y_n),\\
        k_2 = f(t_n + \frac{\tau}{2}, y_n + \frac{\tau}{2} k_1),\\
        k_3 = f(t_n + \frac{\tau}{2}, y_n + \frac{\tau}{2} k_2),\\
        k_4 = f(t_n + \tau, y_n + \tau k_3).
    \end{cases}
\end{equation}
\[ y_{n+1} = y_n + \frac{\tau}{6}(k_1 + 2k_2 + 2k_3 + k_4). \]

\section{Dvipakopis Rungės-Kuto metodas}
Dvipakopių Rugės-Kuto metodų šeima:
\begin{equation}
    \begin{cases}
        k_1 = f(t_n, y_n),\\
        k_2 = f(t_n + \frac{\tau}{2 \sigma}, y_n + \frac{\tau}{2 \sigma} k_1)
    \end{cases}
\end{equation}
\[ y_{n+1} = y_n + \tau [(1 - \sigma) k_1 + \sigma k_2]\]

Naudojant $\sigma = 0.5$ gauname konkretų prediktoriaus-korektoriaus metodą:
\begin{equation}
    \begin{cases}
        k_1 = f(t_n, y_n),\\
        k_2 = f(t_n + \tau, y_n + \tau k_1)
    \end{cases}
\end{equation}
\[ y_{n+1} = y_n + \frac{\tau}{2} (k_1 + k_2). \]

\begin{figure}
    \begin{center}
        \input{./pytex/tau1_simple.pgf}
    \end{center}
    \caption{Koši uždavinio sprendinių, gautų skirtingais metodais kai $\tau = \tone$, grafikas.}
\end{figure}
\begin{figure}
    \begin{center}
        \input{./pytex/tau2_simple.pgf}
    \end{center}
    \caption{Koši uždavinio sprendinių, gautų skirtingais metodais kai $\tau = \ttwo$, grafikas.}
\end{figure}
\begin{figure}
    \begin{center}
        \input{./pytex/tau1_diff.pgf}
    \end{center}
    \caption{Koši uždavinio sprendinių, gautų su \texttt{RK2} ir \texttt{RK4} metodais kai $\tau = \tone$, skirtumų grafikas.}
\end{figure}
\begin{figure}
    \begin{center}
        \input{./pytex/tau2_diff.pgf}
    \end{center}
    \caption{Koši uždavinio sprendinių, gautų kai $\tau = \ttwo$, skirtumo su \texttt{solve_ivp} sprendiniais grafikas.}
\end{figure}
\begin{figure}
    \begin{center}
        \input{./pytex/tau1_diff_ivp.pgf}
    \end{center}
    \caption{Koši uždavinio sprendinių, gautų kai $\tau = \tone$, grafikas.}
\end{figure}
\begin{figure}
    \begin{center}
        \input{./pytex/tau2_diff_ivp.pgf}
    \end{center}
    \caption{lol}
\end{figure}

% \bigskip
% \input{./pytex/rt4_t1.tex}
% \input{./pytex/rt4_t2.tex}
% \input{./pytex/rt2_t1.tex}
% \input{./pytex/rt2_t2.tex}

\end{document}
